<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="gray-bg">

<div class="container-div">
    <div class="row">
        <div class="col-sm-12 search-collapse">
            <form id="operlog-form">
                <div class="select-list">
                    <ul>
                        <input type="hidden" id="userId" name="userId" th:value="${vo.userId}"/>
                        <input  type="hidden" id="id" name="id"  th:value="${vo.id}"/>
                    </ul>
                </div>
            </form>
        </div>

        <div class="btn-group-sm" role="group">
            <a class="btn btn-success" onclick="feminaList()" >
                <i class="fa fa-reply-all"></i> 母狗
            </a>
            <a class="btn btn-success" onclick="maleList()" >
                <i class="fa fa-reply-all"></i> 公狗
            </a>
            <a class="btn btn-success" onclick="puppyList()" >
                <i class="fa fa-reply-all"></i> 小狗
            </a>
            <a class="btn btn-success" onclick="historyListInfo()" >
                <i class="fa fa-reply-all"></i> 动态
            </a>
            <a class="btn btn-success" onclick="accountListInfo()" >
                <i class="fa fa-reply-all"></i> 挖矿
            </a>
            <a class="btn btn-success" onclick="backpackUseInfo()" >
                <i class="fa fa-reply-all"></i> 装备
            </a>
        </div>

        <div class="col-sm-12 select-table table-striped">
            <table id="bootstrap-table" data-mobile-responsive="true"></table>
        </div>
    </div>
</div>

<div th:include="include :: footer"></div>
<script th:inline="javascript">
    var deitConfig = [[${@permission.hasPermi('betaMaleList:edit')}]];
    var orderListList = [[${@permission.hasPermi('betaOrderInfo:view')}]];
    var orderListDelete = [[${@permission.hasPermi('orderList:delete')}]];
    var premiumstautss = [[${@dict.getType('premium_Stauts')}]];
    var betaActivates = [[${@dict.getType('beta_activate')}]];
    var betaplatformanduser = [[${@dict.getType('beta_platform_and_user')}]];
    var betasellStatus = [[${@dict.getType('beta_sell_Status')}]];
    var betaOrderStauts = [[${@dict.getType('beta_order_stauts')}]];
    var prefix = ctx + "beta/betaMale";
    $(function () {
        var options = {
            url: prefix + "/list",
            createUrl: prefix + "/add",
            updateUrl: prefix + "/edit/{id}",
            sortName: "b.create_time",
            sortOrder: "desc",
            modalName: "公狗",
            queryParams: queryParams,
            search: false,
            showExport: false,
            columns: [
                {
                    field: 'dogName',
                    title: '套餐名称'
                },
                {
                    field: 'createTime',
                    title: '创建时间'
                },
                {
                    field: 'price',
                    title: '公狗价格'
                },
                {
                    field: 'earningsPrice',
                    title: '收益价'
                },
                {
                    field: 'premiumStauts',
                    title: '是否溢价',
                    formatter: function (value, row, index) {
                        return $.table.selectDictLabel(premiumstautss, value);
                    }
                },
                {
                    field: 'betaActivate',
                    title: '是否激活',
                    formatter: function (value, row, index) {
                        return $.table.selectDictLabel(betaActivates, value);
                    }
                },
                {
                    field: 'platformAndUser',
                    title: '创建类型',
                    formatter: function (value, row, index) {
                        return $.table.selectDictLabel(betaplatformanduser, value);
                    }
                },
                {
                    field: 'days',
                    title: '周期（天）',
                    formatter: function (value, row, index) {
                        var actions = [];
                        var loss = row.earningsRatio == null ? "0" : numMulti(row.earningsRatio, 100);
                        var daysAnddifferential = value + "天/" + loss + "%";
                        actions.push('<span class="depreciate">' + daysAnddifferential + '</span>');
                        return actions.join('');
                    }
                },
                {
                    field: 'startTime',
                    title: '抢~放（狗）时段',
                    formatter: function (value, row, index) {
                        var actions = [];
                        var startTimeAndEndTime = value + "~" + row.endTime;
                        actions.push('<span class="depreciate">' + startTimeAndEndTime + '</span>');
                        return actions.join('');
                    }
                },
                {
                    field: 'minPrice',
                    title: '最低价格（最低价）',
                    formatter: function (value, row, index) {
                        var actions = [];
                        var minPriceAndmaxPrice = value + "~" + row.maxPrice;
                        actions.push('<span class="depreciate">' + minPriceAndmaxPrice + '</span>');
                        return actions.join('');
                    }
                },
                {
                    field: 'level',
                    title: '级别'
                },
                {
                    field: 'differential',
                    title: '消耗微分'
                },
                {
                    field: 'name',
                    title: '所属人',
                    formatter: function (value, row, index) {
                        var actions = [];
                        var nameAndPhone = value + "/" + row.phone;
                        actions.push('<span class="depreciate">' + nameAndPhone + '</span>');
                        return actions.join('');
                    }
                },
                {
                    field: 'sellStatus',
                    title: '是否出售',
                    formatter: function (value, row, index) {
                        return $.table.selectDictLabel(betasellStatus, value);
                    }
                },
                {
                    field: 'orderStauts',
                    title: '最新订单状态',
                    formatter: function (value, row, index) {
                        return $.table.selectDictLabel(betaOrderStauts, value);
                    }
                },
                {
                    field: 'presellTime',
                    title: '预售时间'
                },
                {
                    title: '操作',
                    align: 'center',
                    formatter: function (value, row, index) {
                        var actions = [];
                        actions.push('<a class="btn btn-success btn-xs' + deitConfig + '" href="#" onclick="$.operate.edit(\'' + row.id + '\')"><i class="fa fa-edit"></i>详情</a> ')
                        actions.push('<a class="btn btn-info btn-xs' + orderListList + '" href="#" onclick="betaOrader(\'' + row.id + '\')"><i class="fa fa-key"></i>订单列表</a>');
                        return actions.join('');
                    }
                }]
        };
        $.table.init(options);
    });

    /*历史订单*/
    function betaOrderList(id) {
        var url = prefix + '/betaOrderInfoList/' + id;
        $.modal.openFull("历史订单", url, 888, 450)
    }


    /*字典列表-详细*/
    function betaOrader(id) {
        var url = prefix + '/betaOrader/' + id;
        createMenuItem(url, "订单列表");
    }

    function refreshBetaMale() {
        var index = layer.msg('刷新中', {
            icon: 16,
            shade: 0.1,
            time: false
        });
        $.ajax({
            url: prefix + "/refreshRedis",
            data: {},
            cache: false,
            dataType: "json",
            type: 'POST',
            success: function (result) {
                layer.close(index);
                if (result.code == web_status.SUCCESS) {
                    $.modal.closeAll();
                    $.modal.alertSuccess(result.result);
                    $.table.refresh();
                } else {
                    $.modal.alertError(result.result);
                }
            }
        });
    }

    function queryParams(params) {
        return {
            userId:       $("#userId").val(),
            pageSize:       params.limit,
            pageNum:        params.offset / params.limit + 1,
            searchValue:    params.search,
            orderByColumn:  params.sort,
            isAsc:          params.order
        };
    }

    /*狗窝-母狗列表*/
    function feminaList(id) {
        var id = document.getElementById("id").value
        var url ='betaHouse/house/feminaList/' + id;
        createMenuItem(url, "母狗列表");
    }
    /*狗窝_公狗列表*/
    function maleList() {
        var id = document.getElementById("id").value

        var url = 'betaHouse/house/maleList/'+id;
        createMenuItem(url, "公狗列表");
    }

    /*狗窝_小狗列表*/
    function puppyList() {
        var id = document.getElementById("id").value
        var url = 'betaHouse/house/puppyList/'+id;
        createMenuItem(url, "小狗列表");
    }

    /*狗窝_动态列表*/
    function historyListInfo() {
        var id = document.getElementById("id").value
        var url = 'betaHouse/house/historyListInfo/'+id;
        createMenuItem(url, "动态列表");
    }

    /*狗窝_动态列表*/
    function accountListInfo() {
        var id = document.getElementById("id").value
        var url = 'betaHouse/house/accountListInfo/'+id;
        createMenuItem(url, "挖矿列表");
    }

    /*狗窝_装备列表*/
    function backpackUseInfo() {
        var id = document.getElementById("id").value
        var url = 'betaHouse/house/backpackUseInfo/'+id;
        createMenuItem(url, "装备列表");
    }
</script>
</body>
</html>