<!DOCTYPE html>
<html class="x-admin-sm">

<head>
  <meta charset="UTF-8">
  <title>添加销售代表</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8" />
  <link rel="stylesheet" href="/statics/css/font.css">
  <link rel="stylesheet" href="/statics/css/xadmin.css">
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" src="/statics/lib/layui/layui.js" charset="utf-8"></script>
  <script type="text/javascript" src="/statics/js/xadmin.js"></script>
  <script type="text/javascript" src="/statics/js/cookie.js"></script>
  <script src="/statics/js/pinyin.js/initials.js"></script>
  <script src="/statics/js/pinyin.js/pinyin.js"></script>
  <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
  <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
  <div class="x-body" id="getAgent">
    <form class="layui-form">



      <!--用户名-->
      <div class="layui-form-item">
        <label for="username" class="layui-form-label">
          <span class="x-red">*</span>登录名
        </label>
        <div class="layui-input-inline">
          <input type="text" id="username" name="username" required="" lay-verify="required"
                 autocomplete="off" class="layui-input">
        </div>
        <div class="layui-form-mid layui-word-aux">
          <span class="x-red">*</span>唯一的登入名
        </div>
      </div>
      <div class="layui-form-item">
        <label for="username" class="layui-form-label">
          昵称
        </label>
        <div class="layui-input-inline">
          <input type="text" id="nickname" name="nickname"  lay-verify="required"
                 autocomplete="off" class="layui-input">
        </div>
      </div>
      <!--密码-->
      <div class="layui-form-item">
        <label for="L_pass" class="layui-form-label">
          <span class="x-red">*</span>密码
        </label>
        <div class="layui-input-inline">
          <input type="password" id="L_pass" name="password" required="" lay-verify="pass"
                 autocomplete="off" class="layui-input">
        </div>
        <div class="layui-form-mid layui-word-aux">
          6到16个字符
        </div>
      </div>
      <!--确定密码-->
      <div class="layui-form-item">
        <label for="L_repass" class="layui-form-label">
          <span class="x-red">*</span>确认密码
        </label>
        <div class="layui-input-inline">
          <input type="password" id="L_repass" name="repass" required="" lay-verify="repass"
                 autocomplete="off" class="layui-input">
        </div>
      </div>
      <!-- 代理商 -->
      <div class="layui-form-item">
        <label for="username" class="layui-form-label">
          <span class="x-red">*</span>代理商
        </label>
        <div class="layui-input-inline">
          <select name="agentNo" lay-verify=""  lay-search>
            <option v-for="l in list" :value="l.agentNo">{{l.agentName}}</option>
            <!--<option value="6">6口机</option>-->
            <!--<option value="12">12口机</option>-->
          </select>
        </div>
      </div>

      
      <div class="layui-form-item">
        <label for="L_repass" class="layui-form-label">
        </label>
        <button class="layui-btn" lay-filter="add" lay-submit="">
          添加
        </button>
      </div>
    </form>


  </div>
  <script src="/statics/js/vue.min.js"></script>
  <script src="/statics/js/vue-resource.js"></script>
  <script>
    layui.use(['form', 'layer'], function () {
      $ = layui.jquery;
      var form = layui.form
        , layer = layui.layer;

      //自定义验证规则
      form.verify({
        nikename: function (value) {
          if (value.length < 5) {
            return '昵称至少得5个字符啊';
          }
        }
        , pass: [/(.+){6,12}$/, '密码必须6到12位']
      });

        // 监听提交
        form.on('submit(add)', function(data){
            console.log('add_agent');
            console.log(data);

            //发异步，把数据提交给php
            $.ajax({ type:'post',url: "/addSoleInfo", data: JSON.stringify(data.field),contentType: "application/json",
                success: function(date){

                    //发异步，把数据提交给php
                    layer.alert("增加成功", {icon: 6},function () {
                        // 获得frame索引
                        var index = parent.layer.getFrameIndex(window.name);
                        //关闭当前frame
                        parent.layer.close(index);
                        // 可以对父窗口进行刷新
                        x_admin_father_reload();
                    });

                }
            });

            return false;
        });


    });

    var getAgent = new Vue({
        el: "#getAgent",
        data: {
            list:[],
            agentName:'',
            agentNo:''
        },
        mounted:function () {
            var _this = this;
            this.$http.post('/findAllAgentInfo',
                {},{emulateJSON:false}).then(function(res){
                console.log("/add_sole-findAllAgentInfo")
                console.log(res.body)
                _this.list = res.body.list
                if(null == res){

                }
            },function(res){
                console.log(res.status);
            });
        },

        filters: {
            formatDate: function (val) {
                var value = new Date(val);
                var year = value.getFullYear();
                var month = padDate(value.getMonth() + 1);
                var day = padDate(value.getDate());
                var hour = padDate(value.getHours());
                var minutes = padDate(value.getMinutes());
                var seconds = padDate(value.getSeconds());
                return year + '-' + month + '-' + day + ' ' + hour + ':' + minutes + ':' + seconds;

            },

        }
    })
  </script>







</body>

</html>